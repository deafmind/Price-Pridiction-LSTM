# Stock Price Prediction with LSTM

This project implements a stock price prediction model using an LSTM (Long Short-Term Memory) neural network in PyTorch. It consists of two Python scripts: one for data preprocessing and another for training and evaluating the LSTM model.

## Files

- **preprocessing.py**: Loads stock price data (e.g., Google stock from a CSV file), performs cleaning, feature engineering (e.g., moving averages, volatility), scales the data, creates sequences for LSTM input, and splits the data into training and testing sets. The processed data is saved for use in the LSTM script.
- **lstm_torch.py**: Loads the preprocessed data, defines and trains an LSTM model using PyTorch, evaluates its performance, and visualizes actual vs. predicted stock prices.

## Prerequisites

- Python 3.8+
- Required packages:
  - pandas
  - numpy
  - matplotlib
  - scikit-learn
  - torch
  - joblib

Install dependencies using:
```bash
pip install pandas numpy matplotlib scikit-learn torch joblib
```

## Usage

1. **Prepare the Data**:
   - Ensure the input data file (`Google.csv`) is located in the `data` directory relative to `preprocessing.py`.
   - Run the preprocessing script to generate the processed data files:
     ```bash
     python preprocessing.py
     ```
   - This will create `X_train.npy`, `X_test.npy`, `y_train.npy`, `y_test.npy`, `scaler.pkl`, and `features_to_scale.pkl` in the current directory.

2. **Train and Evaluate the LSTM Model**:
   - Ensure the files generated by `preprocessing.py` are in the same directory as `lstm_torch.py`.
   - Run the LSTM script to train the model and visualize predictions:
     ```bash
     python lstm_torch.py
     ```

## Notes

- The `preprocessing.py` script includes an optional section to generate dummy data for testing. Comment out this section to use real data from the CSV file.
- The scripts are designed to be converted to Jupyter notebooks (`.ipynb`) for interactive use. Use a tool like `jupytext` or manually create notebooks by separating code and comments into code