# Stock Price Prediction with LSTM

This project implements a stock price prediction model using an LSTM (Long Short-Term Memory) neural network in PyTorch. It consists of two Python scripts: one for data preprocessing and another for training and evaluating the LSTM model.

## Files

- **preprocessing.ipynb**: Loads stock price data (e.g., Google stock from a CSV file), performs cleaning, feature engineering (e.g., moving averages, volatility), scales the data, creates sequences for LSTM input, and splits the data into training and testing sets. The processed data is saved for use in the LSTM script.
- **lstm_torch.ipynb**: Loads the preprocessed data, defines and trains an LSTM model using PyTorch, evaluates its performance, and visualizes actual vs. predicted stock prices.

## Prerequisites

- Python 3.8+
- Required packages:
  - pandas
  - numpy
  - matplotlib
  - scikit-learn
  - torch
  - joblib

Install dependencies using:
```bash
uv add pandas numpy matplotlib scikit-learn torch joblib
```
or
```bash
uv sync
```

## Usage

1. **Prepare the Data**:
   - Ensure the input data file (`Google.csv`) is located in the `data` directory relative to `preprocessing.ipynb`.
   - This will create `X_train.npy`, `X_test.npy`, `y_train.npy`, `y_test.npy`, `scaler.pkl`, and `features_to_scale.pkl` in the current directory.

2. **Train and Evaluate the LSTM Model**:
   - Ensure the files generated by `preprocessing.ipynb` are in the same directory as `lstm_torch.ipynb`.

## Notes

- The `preprocessing.ipynb` notebook includes an optional section to generate dummy data for testing. Comment out this cell or skip it to use real data from the CSV file.
